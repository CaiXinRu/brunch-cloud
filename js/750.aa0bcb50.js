"use strict";(self["webpackChunkbrunch_cloud"]=self["webpackChunkbrunch_cloud"]||[]).push([[750],{3421:function(t,s,a){var d=a(6086),r=a(6154),i=a(7587);s["Z"]=(0,d.Q_)("cart",{state:()=>({isLoading:!1,cart:{},status:{loadingItem:""},$httpMessageState:i.Z}),getters:{},actions:{getCart(){const t="https://vue3-course-api.hexschool.io/api/brunch-cloud/cart";this.isLoading=!0,r.Z.get(t).then((t=>{console.log(t.data.data.carts.length),this.cart=t.data.data,this.isLoading=!1}))},updateCart(t){const s=`https://vue3-course-api.hexschool.io/api/brunch-cloud/cart/${t.id}`;this.status.loadingItem=t.id;const a={product_id:t.product_id,qty:t.qty};r.Z.put(s,{data:a}).then((t=>{this.status.loadingItem="",this.getCart()}))},plusCount(t){t.qty+=1,this.updateCart(t)},minusCount(t){t.qty>1?(t.qty-=1,this.updateCart(t)):1===t.qty&&this.removeCartItem(t.id)},removeCartItem(t){const s=`https://vue3-course-api.hexschool.io/api/brunch-cloud/cart/${t}`;this.isLoading=!0,r.Z["delete"](s).then((t=>{this.$httpMessageState(t,"移除購物車品項"),this.getCart(),this.isLoading=!1}))}}})},2056:function(t,s,a){a.d(s,{Z:function(){return p}});var d=a(6252),r=a(8508);const i=t=>((0,d.dD)("data-v-1e343382"),t=t(),(0,d.Cn)(),t),e={class:"loading-bg"},c=i((()=>(0,d._)("img",{src:r,alt:"Loading..."},null,-1))),o=[c];function l(t,s){return(0,d.wg)(),(0,d.iD)("div",e,o)}var h=a(3744);const n={},u=(0,h.Z)(n,[["render",l],["__scopeId","data-v-1e343382"]]);var p=u},5750:function(t,s,a){a.r(s),a.d(s,{default:function(){return dt}});var d=a(6252),r=a(3577);const i=t=>((0,d.dD)("data-v-3d4126a9"),t=t(),(0,d.Cn)(),t),e={class:"bg-color--white"},c={class:"container u-pt-48 u-pb-48"},o={class:"co-stepbar"},l=(0,d.uE)('<div class="co-step" data-v-3d4126a9><div class="cs-num" data-v-3d4126a9>1</div><div class="cs-text" data-v-3d4126a9>購物訂單</div><div class="cs-bar" data-v-3d4126a9></div></div><div class="co-step" data-v-3d4126a9><div class="cs-num" data-v-3d4126a9>2</div><div class="cs-text" data-v-3d4126a9>填寫資料</div><div class="cs-bar" data-v-3d4126a9></div></div><div class="co-step" data-v-3d4126a9><div class="cs-num" data-v-3d4126a9>3</div><div class="cs-text" data-v-3d4126a9>確認訂單</div><div class="cs-bar" data-v-3d4126a9></div></div>',3),h={class:"co-step"},n=i((()=>(0,d._)("div",{class:"cs-text"},"完成付款",-1))),u=i((()=>(0,d._)("div",{class:"co-step-sm"},[(0,d._)("div",{class:"cs-num"},"3"),(0,d._)("div",{class:"cs-text"},"確認訂單"),(0,d._)("div",{class:"cs-bar"})],-1))),p={style:{width:"100%"},class:"cf-table"},_={class:"cf-id"},g={style:{width:"100%"}},v=i((()=>(0,d._)("thead",null,[(0,d._)("tr",{class:"cf-head"},[(0,d._)("th",{style:{width:"40%"}},"品名"),(0,d._)("th",{style:{width:"30%"}},"小計"),(0,d._)("th",{style:{width:"30%"}},"數量")])],-1))),y={style:{width:"40%","border-right":"3px solid #fac664"}},b={style:{width:"30%","border-right":"3px solid #fac664"}},w={style:{width:"30%"}},f={class:"cf-total"},k=i((()=>(0,d._)("td",{style:{width:"40%"}},"總計",-1))),m={style:{width:"60%","background-color":"var(--color--light-brown)"}},x={style:{width:"100%"},class:"cf-table2"},C=i((()=>(0,d._)("thead",null,[(0,d._)("tr",{class:"cf-head"},[(0,d._)("th",{style:{width:"100%"}},"顧客資料")])],-1))),$={style:{height:"50px"},class:"cf-body"},L=i((()=>(0,d._)("td",{style:{width:"40%","border-right":"3px solid #fac664"},class:"color--dark-brown"}," 收件人姓名 ",-1))),I={style:{width:"60%"},class:"color--black"},z={style:{height:"50px"},class:"cf-body"},Z=i((()=>(0,d._)("td",{style:{width:"40%","border-right":"3px solid #fac664"},class:"color--dark-brown"}," 聯絡電話 ",-1))),q={style:{width:"60%"},class:"color--black"},D={style:{height:"50px"},class:"cf-body"},O=i((()=>(0,d._)("td",{style:{width:"40%","border-right":"3px solid #fac664"},class:"color--dark-brown"}," Email ",-1))),M={style:{width:"60%"},class:"color--black"},E={style:{height:"50px"},class:"cf-body"},H=i((()=>(0,d._)("td",{style:{width:"40%","border-right":"3px solid #fac664"},class:"color--dark-brown"}," 收件地址 ",-1))),N={style:{width:"60%"},class:"color--black"},P={style:{height:"50px"},class:"cf-body"},S=i((()=>(0,d._)("td",{style:{width:"40%","border-right":"3px solid #fac664"},class:"color--dark-brown"}," 訂／送餐日期 ",-1))),T={style:{width:"60%"},class:"color--black"},Y={style:{height:"50px"},class:"cf-body"},j=i((()=>(0,d._)("td",{style:{width:"40%","border-right":"3px solid #fac664"},class:"color--dark-brown"}," 留言備註 ",-1))),K={style:{width:"60%"},class:"color--black"},Q={style:{height:"50px"},class:"cf-body"},U=i((()=>(0,d._)("td",{style:{width:"40%","border-right":"3px solid #fac664"},class:"color--dark-brown"}," 付款狀態 ",-1))),W={style:{width:"60%"},class:"color--black"},A={key:0,class:"color--negative"},B={key:1,class:"color--positive"},F={key:0,class:"cf-submit-container"},G={key:1,class:"cf-submit-container"};function J(t,s,a,i,J,R){const V=(0,d.up)("LoadingPage"),X=(0,d.up)("router-link");return(0,d.wg)(),(0,d.iD)(d.HY,null,[t.isLoading?((0,d.wg)(),(0,d.j4)(V,{key:0})):(0,d.kq)("",!0),(0,d._)("div",e,[(0,d._)("div",c,[(0,d._)("div",o,[l,(0,d._)("div",h,[(0,d._)("div",{class:(0,r.C_)(["cs-num",{"cs-lighter":!t.order?.is_paid}])},"4",2),n,(0,d._)("div",{class:(0,r.C_)(["cs-bar",{"cs-lighter":!t.order?.is_paid}])},null,2)]),u]),(0,d._)("table",p,[(0,d._)("thead",null,[(0,d._)("tr",_,[(0,d._)("th",g,"訂單編號："+(0,r.zw)(t.order?.id),1)])]),v,(0,d._)("tbody",null,[((0,d.wg)(!0),(0,d.iD)(d.HY,null,(0,d.Ko)(t.order.products,(s=>((0,d.wg)(),(0,d.iD)("tr",{style:{height:"100px"},class:"color--dark-brown cf-body",key:s.id},[(0,d._)("td",y,(0,r.zw)(s.product.title),1),(0,d._)("td",b," NT$"+(0,r.zw)(t.$filters.currency(s.final_total)),1),(0,d._)("td",w,(0,r.zw)(s.qty)+" 份",1)])))),128))]),(0,d._)("tfoot",null,[(0,d._)("tr",f,[k,(0,d._)("td",m," NT$"+(0,r.zw)(t.$filters.currency(Math.floor(t.order.total))),1)])])]),(0,d._)("table",x,[C,(0,d._)("tbody",null,[(0,d._)("tr",$,[L,(0,d._)("td",I,(0,r.zw)(t.order.user.name),1)]),(0,d._)("tr",z,[Z,(0,d._)("td",q,(0,r.zw)(t.order.user.tel),1)]),(0,d._)("tr",D,[O,(0,d._)("td",M,(0,r.zw)(t.order.user.email),1)]),(0,d._)("tr",E,[H,(0,d._)("td",N,(0,r.zw)(t.order.user.address),1)]),(0,d._)("tr",P,[S,(0,d._)("td",T,(0,r.zw)(t.$filters.date(t.order.create_at)),1)]),(0,d._)("tr",Y,[j,(0,d._)("td",K,(0,r.zw)(t.order.message),1)]),(0,d._)("tr",Q,[U,(0,d._)("td",W,[t.order?.is_paid?((0,d.wg)(),(0,d.iD)("span",B,"付款完成")):((0,d.wg)(),(0,d.iD)("span",A,"尚未付款"))])])])]),t.order?.is_paid?(0,d.kq)("",!0):((0,d.wg)(),(0,d.iD)("div",F,[(0,d._)("div",{class:"cf-submit",type:"submit",onClick:s[0]||(s[0]=(...t)=>R.payOrder&&R.payOrder(...t))},"進行付款")])),t.order?.is_paid?((0,d.wg)(),(0,d.iD)("div",G,[(0,d.Wm)(X,{to:"/menu",class:"cf-submit",type:"submit"},{default:(0,d.w5)((()=>[(0,d.Uk)(" 繼續點餐 ")])),_:1})])):(0,d.kq)("",!0)])])],64)}a(7658);var R=a(2056),V=a(6086),X=a(3421),tt={data:()=>({order:{user:{}},orderId:""}),components:{LoadingPage:R.Z},computed:{...(0,V.rn)(X.Z,["isLoading","cart","status"])},methods:{...(0,V.nv)(X.Z,["getCart"]),async getOrder(){const t=`https://vue3-course-api.hexschool.io/api/brunch-cloud/order/${this.orderId}`;this.isLoading=!0;const s=await this.$http.get(t);return console.log(s),s.data.success&&(this.order=s.data.order),this.isLoading=!1,s},async payOrder(){const t=`https://vue3-course-api.hexschool.io/api/brunch-cloud/pay/${this.orderId}`;this.isLoading=!0;const s=await this.$http.post(t);if(s.data.success){const t=await this.getOrder();this.$router.push(`/checkpay/${t.data.order.id}`),this.getCart()}return this.isLoading=!1,s}},created(){this.orderId=this.$route.params.orderId,this.getOrder()}},st=a(3744);const at=(0,st.Z)(tt,[["render",J],["__scopeId","data-v-3d4126a9"]]);var dt=at},8508:function(t,s,a){t.exports=a.p+"img/cloud.bc85b219.gif"}}]);
//# sourceMappingURL=750.aa0bcb50.js.map